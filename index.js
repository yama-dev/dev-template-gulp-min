"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("gulp"),t=require("fs"),r=require("node-notifier"),s=require("gulp-sass"),i=require("node-sass"),n=require("gulp-postcss"),o=require("pixrem"),a=require("autoprefixer"),c=require("cssnano"),u=require("css-declaration-sorter"),l=require("postcss-combine-media-query"),h=require("gulp-cached"),p=require("gulp-plumber"),f=require("path");require("colors");var d=require("gulp-if"),g=require("gulp-javascript-obfuscator"),m=require("gulp-terser"),y=require("gulp-eslint"),v=require("gulp-prettier"),b=require("gulp-babel"),w=require("webpack"),_=require("webpack-stream"),j=require("@yama-dev/gulp-stream-util"),$=require("gulp-ejs");require("gulp-pug");var k=require("gulp-rename"),E=require("gulp-htmlmin"),O=require("@yama-dev/data-collector"),A=require("@yama-dev/data-template"),D=require("gulp-ignore"),S=require("gulp-htmlhint"),x=require("browser-sync"),I=require("util"),q=require("events"),C=require("assert"),L=require("del"),B=require("child_process"),M=require("gulp-prompt"),T=require("gulp-imagemin");function R(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var P=R(t),N=R(r),G=R(s),F=R(i),Q=R(n),W=R(o),z=R(a),U=R(c),H=R(u),K=R(l),Z=R(h),V=R(p),J=R(f),X=R(d),Y=R(g),ee=R(m),te=R(y),re=R(v),se=R(b),ie=R(w),ne=R(_),oe=R(j),ae=R($),ce=R(k),ue=R(E),le=R(O),he=R(A),pe=R(D),fe=R(S),de=R(x),ge=R(I),me=R(q),ye=R(C),ve=R(L),be=R(M),we=R(T),_e={name:"make_dev-template-gulp-min",version:"0.0.2",description:"",author:"yama-dev",license:"MIT",main:"index.js",scripts:{build:"rollup -c"},devDependencies:{"@rollup/plugin-commonjs":"^16.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^10.0.0","rollup-plugin-terser":"^7.0.2"}};let je={},$e={};try{je=P.default.readFileSync("./.config.json","utf8"),je=JSON.parse(je)}catch(e){console.log("[dev-template] not use .config.json")}$e={source:"src/",sourceBuild:"",release:"release/"},je.inputDirectory&&($e.source=je.inputDirectory),je.outputDirectory?$e.sourceBuild=je.outputDirectory:$e.sourceBuild=$e.source;let ke=je,Ee=$e,Oe={sourcemaps:!1,htmlLint:!0,php:!1,jsLint:!0,jsMin:!1,hide:!1,obfuscator:!1,obfuscatorMax:!1,cssMin:!1,cssSortPropaty:!0,cssMergeMediaQuery:!0};const Ae=process.argv.slice(2);Ae.map(((e,t)=>{if(/--/.test(e)){let r=e.replace("--","");if(Ae[t+1]){/--/.test(Ae[t+1])?Oe[r]=!0:Oe[r]=Ae[t+1];let e="false"!==Oe[r]&&Oe[r];"true"===e&&(e=!0),Oe[r]=e}else Oe[r]=!0}}));let De={path:Ee,user:ke,env:Oe,outputDirectory:{dev:Ee.sourceBuild,release:Ee.release},watchDirectory:{html:`${Ee.sourceBuild}**/*.html`,ejs:`${Ee.source}**/*.ejs`,pug:`${Ee.source}**/*.pug`,slim:`${Ee.source}**/*.slim`,php:`${Ee.sourceBuild}**/*.php`,css:`${Ee.sourceBuild}**/*.css`,sass:`${Ee.source}**/*.scss`,jspre:`${Ee.source}**/*.js`,js:`${Ee.sourceBuild}**/*.js`,es:`${Ee.source}**/*.es*`},watchIgnoreDirectory:{html:[`!${Ee.source}**/wp/**/*.html`,`!${Ee.source}**/vender/**/*.html`,`!${Ee.source}**/vendor/**/*.html`,`!${Ee.source}**/inc/**/*.html`,`!${Ee.source}**/include/**/*.html`,`!${Ee.source}**/ssi/**/*.html`,`!${Ee.source}_*/**/*.html`,`!${Ee.source}__*/**/*.html`,`!${Ee.source}___*/**/*.html`,`!${Ee.sourceBuild}**/wp/**/*.html`,`!${Ee.sourceBuild}**/vender/**/*.html`,`!${Ee.sourceBuild}**/vendor/**/*.html`,`!${Ee.sourceBuild}**/inc/**/*.html`,`!${Ee.sourceBuild}**/include/**/*.html`,`!${Ee.sourceBuild}**/ssi/**/*.html`,`!${Ee.sourceBuild}_*/**/*.html`,`!${Ee.sourceBuild}__*/**/*.html`,`!${Ee.sourceBuild}___*/**/*.html`],ejs:[`!${Ee.source}**/_*.ejs`,`!${Ee.source}_*/**/*.ejs`,`!${Ee.source}__*/**/*.ejs`,`!${Ee.source}___*/**/*.ejs`],pug:[`!${Ee.source}**/_*.pug`,`!${Ee.source}_*/**/*.pug`,`!${Ee.source}__*/**/*.pug`,`!${Ee.source}___*/**/*.pug`],slim:[`!${Ee.source}**/_*.slim`,`!${Ee.source}_*/**/*.slim`,`!${Ee.source}__*/**/*.slim`,`!${Ee.source}___*/**/*.slim`],sass:[`!${Ee.source}**/wp/**/*.scss`,`!${Ee.source}**/vender/**/*.scss`,`!${Ee.source}**/vendor/**/*.scss`,`!${Ee.source}**/lib/**/*.scss`,`!${Ee.source}**/libs/**/*.scss`,`!${Ee.source}_*/**/*.scss`,`!${Ee.source}__*/**/*.scss`,`!${Ee.source}___*/**/*.scss`],css:[`!${Ee.source}**/_*.css`,`!${Ee.source}_*/**/*.css`,`!${Ee.source}__*/**/*.css`,`!${Ee.source}___*/**/*.css`,`!${Ee.sourceBuild}**/_*.css`,`!${Ee.sourceBuild}_*/**/*.css`,`!${Ee.sourceBuild}__*/**/*.css`,`!${Ee.sourceBuild}___*/**/*.css`],js:[`!${Ee.source}**/wp/**/*.js`,`!${Ee.source}**/vender/**/*.js`,`!${Ee.source}**/vendor/**/*.js`,`!${Ee.source}**/lib/**/*.js`,`!${Ee.source}**/libs/**/*.js`,`!${Ee.source}**/*.min.js`,`!${Ee.source}_*/**/*.js`,`!${Ee.source}__*/**/*.js`,`!${Ee.source}___*/**/*.js`,`!${Ee.sourceBuild}**/wp/**/*.js`,`!${Ee.sourceBuild}**/vender/**/*.js`,`!${Ee.sourceBuild}**/vendor/**/*.js`,`!${Ee.sourceBuild}**/lib/**/*.js`,`!${Ee.sourceBuild}**/libs/**/*.js`,`!${Ee.sourceBuild}**/*.min.js`,`!${Ee.sourceBuild}_*/**/*.js`,`!${Ee.sourceBuild}__*/**/*.js`,`!${Ee.sourceBuild}___*/**/*.js`]},deployDirectory:[`${Ee.source}**/*`,`!${Ee.source}_*/**`,`!${Ee.source}__*/**`,`!${Ee.source}___*/**`,`!${Ee.source}vender/**`,`!${Ee.source}vendor/**`,`!${Ee.source}**/*.ejs`,`!${Ee.source}**/*.pug`,`!${Ee.source}**/*.slim`,`!${Ee.source}**/_*.css`,`!${Ee.source}**/*.scss`,`!${Ee.source}**/_*.js`,`!${Ee.source}**/*.es*`],imageMinDirectory:[`${Ee.source}**/*.png`,`${Ee.source}**/*.jpg`,`${Ee.source}**/*.jpeg`,`${Ee.source}**/*.gif`,`${Ee.source}**/*.svg`],cleanDirectory:[`${Ee.source}**/*.map`,`${Ee.sourceBuild}**/*.map`,`${Ee.source}**/*.sourcemap`,`${Ee.sourceBuild}**/*.sourcemap`]};
/*!
 * DEV TEMPLATE GULP
 * Repository https://github.com/yama-dev/dev-template-gulp
 * Copyright yama-dev
 * Licensed under the MIT license.
 */(De.user.php||De.env.php)&&(De.user.proxy="127.0.0.1:3333",De.env.htmlLint=!1,De.env.jsLint=!1),(De.user.twig||De.env.twig)&&(De.user.proxy="127.0.0.1:3333",De.env.htmlLint=!1,De.env.jsLint=!1,De.deployDirectory.push(`${Ee.source}**/_twig/**`));const Se=G.default(F.default),xe=(t=!1)=>{!0===t&&(Z.default.caches={});let r=!1;!0===De.user.sourcemaps||!0===De.user.sourcemap?r=!0:!1!==De.user.sourcemaps&&!1!==De.user.sourcemap||(r=!1),!0===De.env.sourcemaps||!0===De.env.sourcemap?r=!0:!1!==De.env.sourcemaps&&!1!==De.env.sourcemap||(r=!1),1!=De.env.production&&1!=De.env.prod||(r=!1);let s=[];(De.env.cssSortPropaty||De.user.cssSortPropaty)&&s.push(H.default({order:"concentric-css"})),(De.env.cssMergeMediaQuery||De.user.cssMergeMediaQuery)&&s.push(K.default()),s=[...s,z.default({grid:!0,cascade:!1}),W.default()],(De.env.cssMin||De.user.cssMin)&&s.push(U.default({autoprefixer:!1}));let i=De.watchIgnoreDirectory.sass.slice();return i.unshift(De.watchDirectory.sass),e.src(i,{sourcemaps:r}).pipe(Z.default("sass")).pipe(V.default({errorHandler(e){N.default.notify({title:"Sass コンパイル エラー",message:e.message})}})).pipe(Se({outputStyle:"expanded",indentType:"space",indentWidth:2,precision:3}).on("error",Se.logError)).pipe(Q.default(s)).pipe(e.dest(De.outputDirectory.dev,{sourcemaps:"."}))};let Ie=()=>{let t=[];if(t.unshift(De.watchDirectory.es),De.path.source!==De.path.sourceBuild&&(t.unshift(De.watchDirectory.jspre),t=[...t,...De.watchIgnoreDirectory.js]),De.user.webpack||De.env.webpack){let e=De.user.webpackConfig?`../../${De.user.webpackConfig}`:"../../webpack.config.js",r=require(e);Object.keys(r.entry).forEach((function(e){t.push(`!${De.path.source}**/${J.default.basename(r.entry[e])}`)}))}let r=!1;!0===De.user.sourcemaps||!0===De.user.sourcemap?r=!0:!1!==De.user.sourcemaps&&!1!==De.user.sourcemap||(r=!1),!0===De.env.sourcemaps||!0===De.env.sourcemap?r=!0:!1!==De.env.sourcemaps&&!1!==De.env.sourcemap||(r=!1),1!=De.env.production&&1!=De.env.prod||(r=!1);let s=!1;!0!==De.user.jsMin&&!0!==De.env.jsMin||(s=!0);let i=!1;!0!==De.user.obfuscator&&!0!==De.env.obfuscator&&!0!==De.user.hide&&!0!==De.env.hide||(s=!1,i=!0);let n={compact:!0,controlFlowFlattening:!1,deadCodeInjection:!1,debugProtection:!1,debugProtectionInterval:!1,disableConsoleOutput:!1,identifierNamesGenerator:"hexadecimal",log:!1,numbersToExpressions:!1,renameGlobals:!1,rotateStringArray:!0,selfDefending:!1,shuffleStringArray:!0,simplify:!0,splitStrings:!1,stringArray:!0,stringArrayEncoding:[],stringArrayWrappersCount:1,stringArrayWrappersChainedCalls:!0,stringArrayWrappersType:"variable",stringArrayThreshold:.75,unicodeEscapeSequence:!1},o={compact:!0,controlFlowFlattening:!0,controlFlowFlatteningThreshold:1,deadCodeInjection:!0,deadCodeInjectionThreshold:1,debugProtection:!0,debugProtectionInterval:!0,disableConsoleOutput:!0,identifierNamesGenerator:"hexadecimal",log:!1,numbersToExpressions:!0,renameGlobals:!1,rotateStringArray:!0,selfDefending:!0,shuffleStringArray:!0,simplify:!0,splitStrings:!0,splitStringsChunkLength:5,stringArray:!0,stringArrayEncoding:["rc4"],stringArrayWrappersCount:5,stringArrayWrappersChainedCalls:!0,stringArrayWrappersType:"function",stringArrayThreshold:1,transformObjectKeys:!0,unicodeEscapeSequence:!1};return!0!==De.user.obfuscatorMax&&!0!==De.env.obfuscatorMax||(o=n),e.src(t,{sourcemaps:r}).pipe(te.default()).pipe(te.default.format()).pipe(V.default({errorHandler(e){N.default.notify({title:"BABEL コンパイル エラー",message:e.message})}})).pipe(se.default()).on("error",(function(e){console.log("[dev-template] ERROR ",e),this.emit("end")})).pipe(re.default({printWidth:300,trailingComma:"es5",tabWidth:2,semi:!0,singleQuote:!0,bracketSpacing:!1})).pipe(X.default(s,ee.default())).pipe(X.default(i,Y.default(o))).pipe(e.dest(De.outputDirectory.dev,{sourcemaps:r}))},qe=()=>{let t=De.watchIgnoreDirectory.js.slice();if(t.unshift(De.watchDirectory.es),De.user.webpack||De.env.webpack){let r=De.user.webpackConfig?`../../${De.user.webpackConfig}`:"../../webpack.config.js";return P.default.existsSync(J.default.join(__dirname,r))?e.src(t).pipe(V.default({errorHandler(e){N.default.notify({title:"WEBPACK コンパイル エラー",message:e.message})}})).pipe(ne.default({config:require(r)},ie.default)).on("error",(function(e){console.log("[dev-template] ERROR ",e),this.emit("end")})).pipe(e.dest(De.outputDirectory.dev)):(console.log(`[dev-template] NOT FOUND ${J.default.join(__dirname,r)}`.white.bgRed),Promise.resolve("not use webpack."))}return Promise.resolve("not use webpack.")},Ce=()=>{let t=De.watchIgnoreDirectory.ejs.slice();t.unshift(De.watchDirectory.ejs);let r=!1;!0!==De.user.htmlMin&&!0!==De.env.htmlMin||(r=!0);let s={};if(s={ejs:{},env:De.env,data:null},De.user.ejs&&(s.ejs=De.user.ejs),De.user.data){console.log("[dev-template] use data.");let e={data:De.user.data.directory?De.user.data.directory:"data",order:De.user.data.order?De.user.data.order:"DESC",orderby:De.user.data.orderby?De.user.data.orderby:"date"};s.data=le.default(e),De.user.data.template&&(console.log("[dev-template] use data-template."),he.default({dataall:s,data:s.data,template:De.user.data.template}))}return e.src(t).pipe(V.default()).pipe(oe.default((function(){if(De.user.ejs){let e=s.ejs.pages.find((e=>e.slug==this.dir));s.ejs.current={},e&&(s.ejs.current=e)}}))).pipe(ae.default(s,{},{ext:""})).pipe(ce.default({extname:""})).pipe(X.default(r,ue.default())).pipe(e.dest(De.outputDirectory.dev))},Le=()=>{let t=De.deployDirectory.slice();if(De.user.webpack||De.env.webpack){let e=De.user.webpackConfig?`../../${De.user.webpackConfig}`:"../../webpack.config.js",r=require(e);Object.keys(r.entry).forEach((function(e){t.push(`!${De.path.source}**/*${J.default.basename(r.entry[e])}`)}))}return e.src(t,{since:e.lastRun(Le)}).pipe(pe.default.include({isFile:!0})).pipe(e.dest(De.outputDirectory.dev))},Be=()=>{let t=De.watchIgnoreDirectory.html.slice();return t.unshift(De.watchDirectory.html),e.src(t).pipe(V.default({errorHandler(e){N.default.notify({title:"HTML LINT エラー",message:e.message}),this.emit("end")}})).pipe(fe.default({"tagname-lowercase":!0,"attr-lowercase":["viewBox"],"attr-value-double-quotes":!0,"attr-value-not-empty":!1,"attr-no-duplication":!0,"doctype-first":!1,"tag-pair":!0,"tag-self-close":!1,"spec-char-escape":!0,"id-unique":!0,"src-not-empty":!0,"alt-require":!0,"head-script-disabled":!1,"img-alt-require":!0,"doctype-html5":!0,"id-class-value":!1,"style-disabled":!1,"space-tab-mixed-disabled":!0,"id-class-ad-disabled":!0,"href-abs-or-rel":!1,"attr-unsafe-chars":!0})).pipe(fe.default.reporter())},Me=()=>{let t=De.watchIgnoreDirectory.html.slice();return t.unshift(De.watchDirectory.html),e.src(t,{since:e.lastRun(Me)}).pipe(ue.default({collapseWhitespace:!0})).pipe(e.dest(De.outputDirectory.dev))};de.default.create();let Te=()=>{let t={reloadDelay:100,reloadDebounce:100,logLevel:"info",logPrefix:"dev-template"};if(De.user.proxy?t.proxy=De.user.proxy:De.env.proxy?t.proxy=De.env.proxy:t.server={baseDir:De.outputDirectory.dev},De.user.host&&(t.host=De.user.host),De.env.host&&(t.host=De.env.host),De.user.startPath&&(t.startPath=De.user.startPath),De.env.startPath&&(t.startPath=De.env.startPath),de.default.init(t),De.path.source!==De.path.sourceBuild){let t=De.deployDirectory.slice();if(De.user.webpack){let e=De.user.webpackConfig?`../${De.user.webpackConfig}`:"../webpack.config.js",r=require(e);Object.keys(r.entry).forEach((function(e){t.push(`!${De.path.source}**/*${J.default.basename(r.entry[e])}`)}))}e.watch(t).on("change",Le),Le()}let r=De.watchIgnoreDirectory.html.slice();r.unshift(De.watchDirectory.html),De.env.htmlMin?e.watch(r,Me):(De.env.htmlLint&&e.watch(r).on("change",(function(e,t){Be()})),e.watch(r).on("change",de.default.reload));const s=De.watchIgnoreDirectory.js.slice();s.unshift(De.watchDirectory.js),De.env.jsMin||De.user.jsMin||De.env.jsLint||De.user.jsLint,e.watch(s).on("change",de.default.reload);const i=De.watchIgnoreDirectory.css.slice();i.unshift(De.watchDirectory.css);e.watch(i).on("change",(function(t,r){e.src(t).pipe(de.default.stream())})),e.watch(De.watchDirectory.php).on("change",de.default.reload),De.user.outputDirectory&&de.default.reload()};var Re="win32"===process.platform,Pe=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function Ne(e){return"function"==typeof e?e:function(){var e;if(Pe){var t=new Error;e=function(e){e&&(t.message=e.message,r(e=t))}}else e=r;return e;function r(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}if(J.default.normalize,Re)var Ge=/(.*?)(?:[\/\\]+|$)/g;else Ge=/(.*?)(?:[\/]+|$)/g;if(Re)var Fe=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else Fe=/^[\/]*/;var Qe=function(e,t){if(e=J.default.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var r,s,i,n,o=e,a={},c={};function u(){var t=Fe.exec(e);r=t[0].length,s=t[0],i=t[0],n="",Re&&!c[i]&&(P.default.lstatSync(i),c[i]=!0)}for(u();r<e.length;){Ge.lastIndex=r;var l=Ge.exec(e);if(n=s,s+=l[0],i=n+l[1],r=Ge.lastIndex,!(c[i]||t&&t[i]===i)){var h;if(t&&Object.prototype.hasOwnProperty.call(t,i))h=t[i];else{var p=P.default.lstatSync(i);if(!p.isSymbolicLink()){c[i]=!0,t&&(t[i]=i);continue}var f=null;if(!Re){var d=p.dev.toString(32)+":"+p.ino.toString(32);a.hasOwnProperty(d)&&(f=a[d])}null===f&&(P.default.statSync(i),f=P.default.readlinkSync(i)),h=J.default.resolve(n,f),t&&(t[i]=h),Re||(a[d]=f)}e=J.default.resolve(h,e.slice(r)),u()}}return t&&(t[o]=e),e},We=function(e,t,r){if("function"!=typeof r&&(r=Ne(t),t=null),e=J.default.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(r.bind(null,null,t[e]));var s,i,n,o,a=e,c={},u={};function l(){var t=Fe.exec(e);s=t[0].length,i=t[0],n=t[0],o="",Re&&!u[n]?P.default.lstat(n,(function(e){if(e)return r(e);u[n]=!0,h()})):process.nextTick(h)}function h(){if(s>=e.length)return t&&(t[a]=e),r(null,e);Ge.lastIndex=s;var c=Ge.exec(e);return o=i,i+=c[0],n=o+c[1],s=Ge.lastIndex,u[n]||t&&t[n]===n?process.nextTick(h):t&&Object.prototype.hasOwnProperty.call(t,n)?d(t[n]):P.default.lstat(n,p)}function p(e,s){if(e)return r(e);if(!s.isSymbolicLink())return u[n]=!0,t&&(t[n]=n),process.nextTick(h);if(!Re){var i=s.dev.toString(32)+":"+s.ino.toString(32);if(c.hasOwnProperty(i))return f(null,c[i],n)}P.default.stat(n,(function(e){if(e)return r(e);P.default.readlink(n,(function(e,t){Re||(c[i]=t),f(e,t)}))}))}function f(e,s,i){if(e)return r(e);var n=J.default.resolve(o,s);t&&(t[i]=n),d(n)}function d(t){e=J.default.resolve(t,e.slice(s)),l()}l()},ze=Je;Je.realpath=Je,Je.sync=Xe,Je.realpathSync=Xe,Je.monkeypatch=function(){P.default.realpath=Je,P.default.realpathSync=Xe},Je.unmonkeypatch=function(){P.default.realpath=Ue,P.default.realpathSync=He};var Ue=P.default.realpath,He=P.default.realpathSync,Ke=process.version,Ze=/^v[0-5]\./.test(Ke);function Ve(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function Je(e,t,r){if(Ze)return Ue(e,t,r);"function"==typeof t&&(r=t,t=null),Ue(e,t,(function(s,i){Ve(s)?We(e,t,r):r(s,i)}))}function Xe(e,t){if(Ze)return He(e,t);try{return He(e,t)}catch(r){if(Ve(r))return Qe(e,t);throw r}}var Ye=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},et=tt;function tt(e,t,r){e instanceof RegExp&&(e=rt(e,r)),t instanceof RegExp&&(t=rt(t,r));var s=st(e,t,r);return s&&{start:s[0],end:s[1],pre:r.slice(0,s[0]),body:r.slice(s[0]+e.length,s[1]),post:r.slice(s[1]+t.length)}}function rt(e,t){var r=t.match(e);return r?r[0]:null}function st(e,t,r){var s,i,n,o,a,c=r.indexOf(e),u=r.indexOf(t,c+1),l=c;if(c>=0&&u>0){if(e===t)return[c,u];for(s=[],n=r.length;l>=0&&!a;)l==c?(s.push(l),c=r.indexOf(e,l+1)):1==s.length?a=[s.pop(),u]:((i=s.pop())<n&&(n=i,o=u),u=r.indexOf(t,l+1)),l=c<u&&c>=0?c:u;s.length&&(a=[n,o])}return a}tt.range=st;var it=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return yt(function(e){return e.split("\\\\").join(nt).split("\\{").join(ot).split("\\}").join(at).split("\\,").join(ct).split("\\.").join(ut)}(e),!0).map(ht)},nt="\0SLASH"+Math.random()+"\0",ot="\0OPEN"+Math.random()+"\0",at="\0CLOSE"+Math.random()+"\0",ct="\0COMMA"+Math.random()+"\0",ut="\0PERIOD"+Math.random()+"\0";function lt(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function ht(e){return e.split(nt).join("\\").split(ot).join("{").split(at).join("}").split(ct).join(",").split(ut).join(".")}function pt(e){if(!e)return[""];var t=[],r=et("{","}",e);if(!r)return e.split(",");var s=r.pre,i=r.body,n=r.post,o=s.split(",");o[o.length-1]+="{"+i+"}";var a=pt(n);return n.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),t.push.apply(t,o),t}function ft(e){return"{"+e+"}"}function dt(e){return/^-?0\d/.test(e)}function gt(e,t){return e<=t}function mt(e,t){return e>=t}function yt(e,t){var r=[],s=et("{","}",e);if(!s||/\$$/.test(s.pre))return[e];var i,n=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),a=n||o,c=s.body.indexOf(",")>=0;if(!a&&!c)return s.post.match(/,.*\}/)?yt(e=s.pre+"{"+s.body+at+s.post):[e];if(a)i=s.body.split(/\.\./);else if(1===(i=pt(s.body)).length&&1===(i=yt(i[0],!1).map(ft)).length)return(h=s.post.length?yt(s.post,!1):[""]).map((function(e){return s.pre+i[0]+e}));var u,l=s.pre,h=s.post.length?yt(s.post,!1):[""];if(a){var p=lt(i[0]),f=lt(i[1]),d=Math.max(i[0].length,i[1].length),g=3==i.length?Math.abs(lt(i[2])):1,m=gt;f<p&&(g*=-1,m=mt);var y=i.some(dt);u=[];for(var v=p;m(v,f);v+=g){var b;if(o)"\\"===(b=String.fromCharCode(v))&&(b="");else if(b=String(v),y){var w=d-b.length;if(w>0){var _=new Array(w+1).join("0");b=v<0?"-"+_+b.slice(1):_+b}}u.push(b)}}else u=function(e,t){for(var r=[],s=0;s<e.length;s++){var i=t(e[s],s);Ye(i)?r.push.apply(r,i):r.push(i)}return r}(i,(function(e){return yt(e,!1)}));for(var j=0;j<u.length;j++)for(var $=0;$<h.length;$++){var k=l+u[j]+h[$];(!t||a||k)&&r.push(k)}return r}var vt=Et;Et.Minimatch=Ot;var bt={sep:"/"};try{bt=J.default}catch(e){}var wt=Et.GLOBSTAR=Ot.GLOBSTAR={},_t={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},jt="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var $t=/\/+/;function kt(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach((function(e){r[e]=t[e]})),Object.keys(e).forEach((function(t){r[t]=e[t]})),r}function Et(e,t,r){if("string"!=typeof t)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new Ot(t,r).match(e))}function Ot(e,t){if(!(this instanceof Ot))return new Ot(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==bt.sep&&(e=e.split(bt.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function At(e,t){if(t||(t=this instanceof Ot?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:it(e)}Et.filter=function(e,t){return t=t||{},function(r,s,i){return Et(r,e,t)}},Et.defaults=function(e){if(!e||!Object.keys(e).length)return Et;var t=Et,r=function(r,s,i){return t.minimatch(r,s,kt(e,i))};return r.Minimatch=function(r,s){return new t.Minimatch(r,kt(e,s))},r},Ot.defaults=function(e){return e&&Object.keys(e).length?Et.defaults(e).Minimatch:Ot},Ot.prototype.debug=function(){},Ot.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map((function(e){return e.split($t)})),this.debug(this.pattern,r),r=r.map((function(e,t,r){return e.map(this.parse,this)}),this),this.debug(this.pattern,r),r=r.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,r),this.set=r},Ot.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=this.options,s=0;if(r.nonegate)return;for(var i=0,n=e.length;i<n&&"!"===e.charAt(i);i++)t=!t,s++;s&&(this.pattern=e.substr(s));this.negate=t},Et.braceExpand=function(e,t){return At(e,t)},Ot.prototype.braceExpand=At,Ot.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===e)return wt;if(""===e)return"";var s,i="",n=!!r.nocase,o=!1,a=[],c=[],u=!1,l=-1,h=-1,p="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",f=this;function d(){if(s){switch(s){case"*":i+="[^/]*?",n=!0;break;case"?":i+="[^/]",n=!0;break;default:i+="\\"+s}f.debug("clearStateChar %j %j",s,i),s=!1}}for(var g,m=0,y=e.length;m<y&&(g=e.charAt(m));m++)if(this.debug("%s\t%s %s %j",e,m,i,g),o&&jt[g])i+="\\"+g,o=!1;else switch(g){case"/":return!1;case"\\":d(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,m,i,g),u){this.debug("  in class"),"!"===g&&m===h+1&&(g="^"),i+=g;continue}f.debug("call clearStateChar %j",s),d(),s=g,r.noext&&d();continue;case"(":if(u){i+="(";continue}if(!s){i+="\\(";continue}a.push({type:s,start:m-1,reStart:i.length,open:_t[s].open,close:_t[s].close}),i+="!"===s?"(?:(?!(?:":"(?:",this.debug("plType %j %j",s,i),s=!1;continue;case")":if(u||!a.length){i+="\\)";continue}d(),n=!0;var v=a.pop();i+=v.close,"!"===v.type&&c.push(v),v.reEnd=i.length;continue;case"|":if(u||!a.length||o){i+="\\|",o=!1;continue}d(),i+="|";continue;case"[":if(d(),u){i+="\\"+g;continue}u=!0,h=m,l=i.length,i+=g;continue;case"]":if(m===h+1||!u){i+="\\"+g,o=!1;continue}if(u){var b=e.substring(h+1,m);try{RegExp("["+b+"]")}catch(e){var w=this.parse(b,Dt);i=i.substr(0,l)+"\\["+w[0]+"\\]",n=n||w[1],u=!1;continue}}n=!0,u=!1,i+=g;continue;default:d(),o?o=!1:!jt[g]||"^"===g&&u||(i+="\\"),i+=g}u&&(b=e.substr(h+1),w=this.parse(b,Dt),i=i.substr(0,l)+"\\["+w[0],n=n||w[1]);for(v=a.pop();v;v=a.pop()){var _=i.slice(v.reStart+v.open.length);this.debug("setting tail",i,v),_=_.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,r){return r||(r="\\"),t+t+r+"|"})),this.debug("tail=%j\n   %s",_,_,v,i);var j="*"===v.type?"[^/]*?":"?"===v.type?"[^/]":"\\"+v.type;n=!0,i=i.slice(0,v.reStart)+j+"\\("+_}d(),o&&(i+="\\\\");var $=!1;switch(i.charAt(0)){case".":case"[":case"(":$=!0}for(var k=c.length-1;k>-1;k--){var E=c[k],O=i.slice(0,E.reStart),A=i.slice(E.reStart,E.reEnd-8),D=i.slice(E.reEnd-8,E.reEnd),S=i.slice(E.reEnd);D+=S;var x=O.split("(").length-1,I=S;for(m=0;m<x;m++)I=I.replace(/\)[+*?]?/,"");var q="";""===(S=I)&&t!==Dt&&(q="$"),i=O+A+S+q+D}""!==i&&n&&(i="(?=.)"+i);$&&(i=p+i);if(t===Dt)return[i,n];if(!n)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var C=r.nocase?"i":"";try{var L=new RegExp("^"+i+"$",C)}catch(e){return new RegExp("$.")}return L._glob=e,L._src=i,L};var Dt={};function St(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}Et.makeRe=function(e,t){return new Ot(e,t||{}).makeRe()},Ot.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",s=t.nocase?"i":"",i=e.map((function(e){return e.map((function(e){return e===wt?r:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,s)}catch(e){this.regexp=!1}return this.regexp},Et.match=function(e,t,r){var s=new Ot(t,r=r||{});return e=e.filter((function(e){return s.match(e)})),s.options.nonull&&!e.length&&e.push(t),e},Ot.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r=this.options;"/"!==bt.sep&&(e=e.split(bt.sep).join("/"));e=e.split($t),this.debug(this.pattern,"split",e);var s,i,n=this.set;for(this.debug(this.pattern,"set",n),i=e.length-1;i>=0&&!(s=e[i]);i--);for(i=0;i<n.length;i++){var o=n[i],a=e;if(r.matchBase&&1===o.length&&(a=[s]),this.matchOne(a,o,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},Ot.prototype.matchOne=function(e,t,r){var s=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,n=0,o=e.length,a=t.length;i<o&&n<a;i++,n++){this.debug("matchOne loop");var c,u=t[n],l=e[i];if(this.debug(t,u,l),!1===u)return!1;if(u===wt){this.debug("GLOBSTAR",[t,u,l]);var h=i,p=n+1;if(p===a){for(this.debug("** at the end");i<o;i++)if("."===e[i]||".."===e[i]||!s.dot&&"."===e[i].charAt(0))return!1;return!0}for(;h<o;){var f=e[h];if(this.debug("\nglobstar while",e,h,t,p,f),this.matchOne(e.slice(h),t.slice(p),r))return this.debug("globstar found match!",h,o,f),!0;if("."===f||".."===f||!s.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,h,t,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",e,h,t,p),h!==o))}if("string"==typeof u?(c=s.nocase?l.toLowerCase()===u.toLowerCase():l===u,this.debug("string match",u,l,c)):(c=l.match(u),this.debug("pattern match",u,l,c)),!c)return!1}if(i===o&&n===a)return!0;if(i===o)return r;if(n===a)return i===o-1&&""===e[i];throw new Error("wtf?")};var xt=St((function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}})),It=St((function(e){try{var t=ge.default;if("function"!=typeof t.inherits)throw"";e.exports=t.inherits}catch(t){e.exports=xt}}));function qt(e){return"/"===e.charAt(0)}function Ct(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),r=t[1]||"",s=Boolean(r&&":"!==r.charAt(1));return Boolean(t[2]||s)}var Lt="win32"===process.platform?Ct:qt,Bt=qt,Mt=Ct;Lt.posix=Bt,Lt.win32=Mt;var Tt=function(e,t,r){r||(r={});if(r.matchBase&&-1===t.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=!1!==r.strict,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0);e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.fs=r.fs||P.default,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(Ht))}(e,r),e.changedCwd=!1;var s=process.cwd();Wt(r,"cwd")?(e.cwd=J.default.resolve(r.cwd),e.changedCwd=e.cwd!==s):e.cwd=s;e.root=r.root||J.default.resolve(e.cwd,"/"),e.root=J.default.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=Lt(e.cwd)?e.cwd:Kt(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,e.minimatch=new zt(t,r),e.options=e.minimatch.options},Rt=Wt,Pt=Kt,Nt=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),s=0,i=e.matches.length;s<i;s++){var n=e.matches[s];if(n&&0!==Object.keys(n).length){var o=Object.keys(n);t?r.push.apply(r,o):o.forEach((function(e){r[e]=!0}))}else if(e.nonull){var a=e.minimatch.globSet[s];t?r.push(a):r[a]=!0}}t||(r=Object.keys(r));e.nosort||(r=r.sort(Ut));if(e.mark){for(s=0;s<r.length;s++)r[s]=e._mark(r[s]);e.nodir&&(r=r.filter((function(t){var r=!/\/$/.test(t),s=e.cache[t]||e.cache[Kt(e,t)];return r&&s&&(r="DIR"!==s&&!Array.isArray(s)),r})))}e.ignore.length&&(r=r.filter((function(t){return!Zt(e,t)})));e.found=r},Gt=function(e,t){var r=Kt(e,t),s=e.cache[r],i=t;if(s){var n="DIR"===s||Array.isArray(s),o="/"===t.slice(-1);if(n&&!o?i+="/":!n&&o&&(i=i.slice(0,-1)),i!==t){var a=Kt(e,i);e.statCache[a]=e.statCache[r],e.cache[a]=e.cache[r]}}return i},Ft=Zt,Qt=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};function Wt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var zt=vt.Minimatch;function Ut(e,t){return e.localeCompare(t,"en")}function Ht(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new zt(r,{dot:!0})}return{matcher:new zt(e,{dot:!0}),gmatcher:t}}function Kt(e,t){var r=t;return r="/"===t.charAt(0)?J.default.join(e.root,t):Lt(t)||""===t?t:e.changedCwd?J.default.resolve(e.cwd,t):J.default.resolve(t),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function Zt(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}var Vt={setopts:Tt,ownProp:Rt,makeAbs:Pt,finish:Nt,mark:Gt,isIgnored:Ft,childrenIgnored:Qt},Jt=rr;rr.GlobSync=sr;var Xt=Vt.setopts,Yt=Vt.ownProp,er=Vt.childrenIgnored,tr=Vt.isIgnored;function rr(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new sr(e,t).found}function sr(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof sr))return new sr(e,t);if(Xt(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var s=0;s<r;s++)this._process(this.minimatch.set[s],s,!1);this._finish()}sr.prototype._finish=function(){if(ye.default(this instanceof sr),this.realpath){var e=this;this.matches.forEach((function(t,r){var s=e.matches[r]=Object.create(null);for(var i in t)try{i=e._makeAbs(i),s[ze.realpathSync(i,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;s[e._makeAbs(i)]=!0}}))}Vt.finish(this)},sr.prototype._process=function(e,t,r){ye.default(this instanceof sr);for(var s,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:s=null;break;default:s=e.slice(0,i).join("/")}var n,o=e.slice(i);null===s?n=".":Lt(s)||Lt(e.join("/"))?(s&&Lt(s)||(s="/"+s),n=s):n=s;var a=this._makeAbs(n);er(this,n)||(o[0]===vt.GLOBSTAR?this._processGlobStar(s,n,a,o,t,r):this._processReaddir(s,n,a,o,t,r))},sr.prototype._processReaddir=function(e,t,r,s,i,n){var o=this._readdir(r,n);if(o){for(var a=s[0],c=!!this.minimatch.negate,u=a._glob,l=this.dot||"."===u.charAt(0),h=[],p=0;p<o.length;p++){if("."!==(g=o[p]).charAt(0)||l)(c&&!e?!g.match(a):g.match(a))&&h.push(g)}var f=h.length;if(0!==f)if(1!==s.length||this.mark||this.stat){s.shift();for(p=0;p<f;p++){var d;g=h[p];d=e?[e,g]:[g],this._process(d.concat(s),i,n)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var p=0;p<f;p++){var g=h[p];e&&(g="/"!==e.slice(-1)?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=J.default.join(this.root,g)),this._emitMatch(i,g)}}}},sr.prototype._emitMatch=function(e,t){if(!tr(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var s=this.cache[r];if("DIR"===s||Array.isArray(s))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},sr.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var s=r&&r.isSymbolicLink();return this.symlinks[e]=s,s||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},sr.prototype._readdir=function(e,t){if(t&&!Yt(this.symlinks,e))return this._readdirInGlobStar(e);if(Yt(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},sr.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var s=t[r];s="/"===e?e+s:e+"/"+s,this.cache[s]=!0}return this.cache[e]=t,t},sr.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var s=new Error(t.code+" invalid cwd "+this.cwd);throw s.path=this.cwd,s.code=t.code,s}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},sr.prototype._processGlobStar=function(e,t,r,s,i,n){var o=this._readdir(r,n);if(o){var a=s.slice(1),c=e?[e]:[],u=c.concat(a);this._process(u,i,!1);var l=o.length;if(!this.symlinks[r]||!n)for(var h=0;h<l;h++){if("."!==o[h].charAt(0)||this.dot){var p=c.concat(o[h],a);this._process(p,i,!0);var f=c.concat(o[h],s);this._process(f,i,!0)}}}},sr.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&Lt(e)&&!this.nomount){var s=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=J.default.join(this.root,e):(e=J.default.resolve(this.root,e),s&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},sr.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&Yt(this.cache,t)){var s=this.cache[t];if(Array.isArray(s)&&(s="DIR"),!r||"DIR"===s)return s;if(r&&"FILE"===s)return!1}var i=this.statCache[t];if(!i){var n;try{n=this.fs.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(n&&n.isSymbolicLink())try{i=this.fs.statSync(t)}catch(e){i=n}else i=n}this.statCache[t]=i;s=!0;return i&&(s=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,(!r||"FILE"!==s)&&s},sr.prototype._mark=function(e){return Vt.mark(this,e)},sr.prototype._makeAbs=function(e){return Vt.makeAbs(this,e)};var ir=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){s[e]=t[e]})),s;function s(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var s=t.apply(this,e),i=e[e.length-1];return"function"==typeof s&&s!==i&&Object.keys(i).forEach((function(e){s[e]=i[e]})),s}};var nr=ir(ar),or=ir(cr);function ar(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function cr(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}ar.proto=ar((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return ar(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return cr(this)},configurable:!0})})),nr.strict=or;var ur=Object.create(null),lr=ir((function(e,t){return ur[e]?(ur[e].push(t),null):(ur[e]=[t],function(e){return nr((function t(){var r=ur[e],s=r.length,i=hr(arguments);try{for(var n=0;n<s;n++)r[n].apply(null,i)}finally{r.length>s?(r.splice(0,s),process.nextTick((function(){t.apply(null,i)}))):delete ur[e]}}))}(e))}));function hr(e){for(var t=e.length,r=[],s=0;s<t;s++)r[s]=e[s];return r}var pr=vr,fr=me.default.EventEmitter,dr=Vt.setopts,gr=Vt.ownProp,mr=Vt.childrenIgnored,yr=Vt.isIgnored;function vr(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return Jt(e,t)}return new wr(e,t,r)}vr.sync=Jt;var br=vr.GlobSync=Jt.GlobSync;function wr(e,t,r){if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new br(e,t)}if(!(this instanceof wr))return new wr(e,t,r);dr(this,e,t),this._didRealPath=!1;var s=this.minimatch.set.length;this.matches=new Array(s),"function"==typeof r&&(r=nr(r),this.on("error",r),this.on("end",(function(e){r(null,e)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===s)return o();for(var n=0;n<s;n++)this._process(this.minimatch.set[n],n,!1,o);function o(){--i._processing,i._processing<=0&&i._finish()}}vr.glob=vr,vr.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),s=r.length;s--;)e[r[s]]=t[r[s]];return e}({},t);r.noprocess=!0;var s=new wr(e,r).minimatch.set;if(!e)return!1;if(s.length>1)return!0;for(var i=0;i<s[0].length;i++)if("string"!=typeof s[0][i])return!0;return!1},vr.Glob=wr,It(wr,fr),wr.prototype._finish=function(){if(ye.default(this instanceof wr),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Vt.finish(this),this.emit("end",this.found)}},wr.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,s)}function s(){0==--e&&t._finish()}},wr.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var s=Object.keys(r),i=this,n=s.length;if(0===n)return t();var o=this.matches[e]=Object.create(null);s.forEach((function(r,s){r=i._makeAbs(r),ze.realpath(r,i.realpathCache,(function(s,a){s?"stat"===s.syscall?o[r]=!0:i.emit("error",s):o[a]=!0,0==--n&&(i.matches[e]=o,t())}))}))},wr.prototype._mark=function(e){return Vt.mark(this,e)},wr.prototype._makeAbs=function(e){return Vt.makeAbs(this,e)},wr.prototype.abort=function(){this.aborted=!0,this.emit("abort")},wr.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},wr.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var s=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<s.length;t++){var i=s[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},wr.prototype._process=function(e,t,r,s){if(ye.default(this instanceof wr),ye.default("function"==typeof s),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,r,s]);else{for(var i,n=0;"string"==typeof e[n];)n++;switch(n){case e.length:return void this._processSimple(e.join("/"),t,s);case 0:i=null;break;default:i=e.slice(0,n).join("/")}var o,a=e.slice(n);null===i?o=".":Lt(i)||Lt(e.join("/"))?(i&&Lt(i)||(i="/"+i),o=i):o=i;var c=this._makeAbs(o);if(mr(this,o))return s();a[0]===vt.GLOBSTAR?this._processGlobStar(i,o,c,a,t,r,s):this._processReaddir(i,o,c,a,t,r,s)}},wr.prototype._processReaddir=function(e,t,r,s,i,n,o){var a=this;this._readdir(r,n,(function(c,u){return a._processReaddir2(e,t,r,s,i,n,u,o)}))},wr.prototype._processReaddir2=function(e,t,r,s,i,n,o,a){if(!o)return a();for(var c=s[0],u=!!this.minimatch.negate,l=c._glob,h=this.dot||"."===l.charAt(0),p=[],f=0;f<o.length;f++){if("."!==(g=o[f]).charAt(0)||h)(u&&!e?!g.match(c):g.match(c))&&p.push(g)}var d=p.length;if(0===d)return a();if(1===s.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(f=0;f<d;f++){var g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=J.default.join(this.root,g)),this._emitMatch(i,g)}return a()}s.shift();for(f=0;f<d;f++){g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),this._process([g].concat(s),i,n,a)}a()},wr.prototype._emitMatch=function(e,t){if(!this.aborted&&!yr(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var r=Lt(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var s=this.cache[r];if("DIR"===s||Array.isArray(s))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}},wr.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,s=lr("lstat\0"+e,(function(s,i){if(s&&"ENOENT"===s.code)return t();var n=i&&i.isSymbolicLink();r.symlinks[e]=n,n||!i||i.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())}));s&&r.fs.lstat(e,s)}},wr.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=lr("readdir\0"+e+"\0"+t,r))){if(t&&!gr(this.symlinks,e))return this._readdirInGlobStar(e,r);if(gr(this.cache,e)){var s=this.cache[e];if(!s||"FILE"===s)return r();if(Array.isArray(s))return r(null,s)}this.fs.readdir(e,function(e,t,r){return function(s,i){s?e._readdirError(t,s,r):e._readdirEntries(t,i,r)}}(this,e,r))}},wr.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var s=0;s<t.length;s++){var i=t[s];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}},wr.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var s=this._makeAbs(e);if(this.cache[s]="FILE",s===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},wr.prototype._processGlobStar=function(e,t,r,s,i,n,o){var a=this;this._readdir(r,n,(function(c,u){a._processGlobStar2(e,t,r,s,i,n,u,o)}))},wr.prototype._processGlobStar2=function(e,t,r,s,i,n,o,a){if(!o)return a();var c=s.slice(1),u=e?[e]:[],l=u.concat(c);this._process(l,i,!1,a);var h=this.symlinks[r],p=o.length;if(h&&n)return a();for(var f=0;f<p;f++){if("."!==o[f].charAt(0)||this.dot){var d=u.concat(o[f],c);this._process(d,i,!0,a);var g=u.concat(o[f],s);this._process(g,i,!0,a)}}a()},wr.prototype._processSimple=function(e,t,r){var s=this;this._stat(e,(function(i,n){s._processSimple2(e,t,i,n,r)}))},wr.prototype._processSimple2=function(e,t,r,s,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!s)return i();if(e&&Lt(e)&&!this.nomount){var n=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=J.default.join(this.root,e):(e=J.default.resolve(this.root,e),n&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()},wr.prototype._stat=function(e,t){var r=this._makeAbs(e),s="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&gr(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!s||"DIR"===i)return t(null,i);if(s&&"FILE"===i)return t()}var n=this.statCache[r];if(void 0!==n){if(!1===n)return t(null,n);var o=n.isDirectory()?"DIR":"FILE";return s&&"FILE"===o?t():t(null,o,n)}var a=this,c=lr("stat\0"+r,(function(s,i){if(i&&i.isSymbolicLink())return a.fs.stat(r,(function(s,n){s?a._stat2(e,r,null,i,t):a._stat2(e,r,s,n,t)}));a._stat2(e,r,s,i,t)}));c&&a.fs.lstat(r,c)},wr.prototype._stat2=function(e,t,r,s,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,i();var n="/"===e.slice(-1);if(this.statCache[t]=s,"/"===t.slice(-1)&&s&&!s.isDirectory())return i(null,!1,s);var o=!0;return s&&(o=s.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,n&&"FILE"===o?i():i(null,o,s)};let _r=()=>{const t=De.watchIgnoreDirectory.sass.slice();t.unshift(De.watchDirectory.sass);e.watch(t).on("change",(function(e,t){let r=J.default.basename(e),s=/^_.{5,}/.test(r);xe(s)}));const r=pr.sync(De.watchDirectory.jspre),s=pr.sync(De.watchDirectory.es);if(s.length||r.length){let t=[];if(r.length&&De.path.source!==De.path.sourceBuild&&(console.log("[dev-template] use js files."),t.unshift(De.watchDirectory.jspre),t=[...t,...De.watchIgnoreDirectory.js]),s.length&&(console.log("[dev-template] use es files."),t.unshift(De.watchDirectory.es)),De.user.webpack||De.env.webpack){let r=[],s=De.user.webpackConfig?`../../${De.user.webpackConfig}`:"../../webpack.config.js",i=require(s);Object.keys(i.entry).forEach((function(e){t.push(`!${De.path.source}**/${J.default.basename(i.entry[e])}`),r.unshift(`${De.path.source}**/*${J.default.basename(i.entry[e])}`)})),e.watch(t,Ie),e.watch(r,qe)}else e.watch(t,Ie)}e.watch(De.watchDirectory.ejs,Ce),N.default.notify({title:"Start Gulp",message:new Date,sound:"Glass"})},jr=e=>{let t=De.cleanDirectory;return ve.default(t,e)},$r=e=>{let t={};t={php:!1,bin:"php",host:"127.0.0.1",port:"3333",baseDir:De.outputDirectory.dev},De.user.php&&(t.php=De.user.php),De.env.php&&(t.php=De.env.php),t.php?B.exec(`${t.bin} -S ${t.host}:${t.port} -t ${t.baseDir}`,((t,r,s)=>{t&&console.log("[dev-template] "+t),e()})):(console.log("[dev-template] PHP Server. Boot failure."),e())},kr=e=>{let t={};t={twig:!1,bin:"php",host:"127.0.0.1",port:"3333",router:"_twig/router.php"},De.user.twig&&(t.twig=De.user.twig),De.env.twig&&(t.twig=De.env.twig),t.twig?B.exec(`cd ${De.outputDirectory.dev} && ${t.bin} -S ${t.host}:${t.port} ${t.router}`,((t,r,s)=>{t&&console.log("[dev-template] "+t),e()})):(console.log("[dev-template] Twig Server. Boot failure."),e())},Er=`${_e.name.toUpperCase()}\n- Version ${_e.version}\n- Copyright ${_e.author}`;console.log("-".repeat(38)+"\n"+Er+"\n"+"-".repeat(38));var Or=e.series(jr,Ce,xe,Ie,qe,e.parallel($r,kr,Te,_r));const Ar=e.series(jr,Ce,xe,Ie,qe,e.parallel($r,kr,Te,_r)),Dr=e.series(jr,Ce,xe,Ie,qe,(()=>{let t=De.deployDirectory.slice();if(De.user.webpack){let e=De.user.webpackConfig?`../../${De.user.webpackConfig}`:"../../webpack.config.js",r=require(e);Object.keys(r.entry).forEach((function(e){t.push(`!${De.path.source}**/*${J.default.basename(r.entry[e])}`)}))}let r="";return e.src("./package.json").pipe(be.default.prompt({type:"input",name:"dir",message:"Please output directory name."},(function(s){return s.dir&&(r=s.dir),!!s.dir&&e.src(t).pipe(pe.default.include({isFile:!0})).pipe(e.dest(r))})))})),Sr=e.series(jr,(()=>{let t=De.imageMinDirectory.slice(),r="",s="",i="",n="";return console.log("-".repeat(38)+"\nImage Minify Task\n filetype: jpg, jpeg, png, gif, svg\n"+"-".repeat(38)),e.src("./package.json").pipe(be.default.prompt([{type:"input",name:"dir",message:"Please output directory name.",default:`image_min_${Date.now()}`},{type:"input",name:"quality",message:"Please `jpg` quality. (0-100)",default:75,validate:function(e){return!(e>100||0>e)}},{type:"input",name:"level_png",message:"Please `png` optimization-level. (0-7)",default:5,validate:function(e){return!(e>7||0>e)}},{type:"input",name:"level_gif",message:"Please `gif` optimization-level. (1-3)",default:1,validate:function(e){return!(e>3||1>e)}}],(function(o){return o.dir&&(r=o.dir),o.quality&&(s=o.quality),o.level_png&&(i=o.level_png),o.level_gif&&(n=o.level_gif),!!o.dir&&e.src(t).pipe(we.default([we.default.gifsicle({interlaced:!0,optimizationLevel:n}),we.default.mozjpeg({quality:s,progressive:!0}),we.default.optipng({optimizationLevel:i}),we.default.svgo({plugins:[{removeViewBox:!0},{cleanupIDs:!1}]})],{verbose:!0})).pipe(pe.default.include({isFile:!0})).pipe(e.dest(r))})))}));exports.default=Or,exports.deploy=Dr,exports.imagemin=Sr,exports.prod=Ar;
